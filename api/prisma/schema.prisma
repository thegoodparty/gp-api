// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

// enable prismaSchemaFolder feature

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
  // previewFeatures = ["prismaSchemaFolder"]
}

generator fakeData {
  provider = "prisma-generator-fake-data"
  output   = "./faker.ts"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ContentType {
  aiChatPrompt
  aiContentTemplate
  articleCategory
  blogArticle
  blogHome
  blogSection
  candidateTestimonial
  election
  faqArticle
  faqOrder
  glossaryItem
  goodPartyTeamMembers
  onboardingPrompts
  pledge
  privacyPage
  promptInputFields
  redirects
  teamMember
  teamMilestone
  termsOfService
}

model Content {
  createdAt DateTime?   @default(now()) @map("created_at")
  updatedAt DateTime?   @updatedAt @map("updated_at")
  id        String      @id
  type      ContentType
  data      Json        @db.JsonB

  @@index([type])
  @@map("content")
}

model PathToVictory {
  id         String   @id @default(uuid())
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")
  campaign   Campaign @relation(fields: [campaignId], references: [id])
  campaignId Int      @unique @map("campaign_id")
  data       Json     @db.JsonB

  @@index([campaignId])
  @@map("path_to_victory")
}

enum CampaignUpdateHistoryType {
  doorKnocking
  calls
  digital
  directMail
  digitalAds
  text
  events
  yardSigns
}

model CampaignUpdateHistory {
  id         String                    @id @default(uuid())
  createdAt  DateTime                  @default(now()) @map("created_at")
  updatedAt  DateTime                  @updatedAt @map("updated_at")
  campaign   Campaign                  @relation(fields: [campaignId], references: [id])
  campaignId Int                       @map("campaign_id")
  // user       User                      @relation(fields: [userId], references: [id])
  // userId     String
  type       CampaignUpdateHistoryType
  quantity   Int

  @@index([campaignId])
  @@map("campaign_update_history")
}

enum CampaignTier {
  WIN
  LOSE
  TOSSUP
}

model Campaign {
  id                    Int                     @id @default(autoincrement())
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime                @updatedAt @map("updated_at")
  slug                  String                  @unique
  /// FAKE:faker.datatype.boolean(0.5)
  isActive              Boolean?                @map("is_active")
  /// FAKE:faker.datatype.boolean(0.5)
  isVerified            Boolean?                @map("is_verified")
  /// FAKE:faker.datatype.boolean(0.5)
  isPro                 Boolean?                @default(false) @map("is_pro")
  /// FAKE:faker.datatype.boolean(0.1)
  isDemo                Boolean                 @default(false) @map("is_demo")
  didWin                Boolean?                @map("did_win")
  dateVerified          DateTime?               @map("date_verified")
  /// FAKE:faker.helpers.arrayElement([CampaignTier.WIN, CampaignTier.LOSE, CampaignTier.TOSSUP])
  tier                  CampaignTier?
  data                  Json                    @default("{}") @db.JsonB
  details               Json                    @default("{}") @db.JsonB
  aiContent             Json                    @default("{}") @map("ai_content") @db.JsonB
  vendorTsData          Json                    @default("{}") @map("vendor_ts_data") @db.JsonB
  pathToVictory         PathToVictory?
  campaignUpdateHistory CampaignUpdateHistory[]

  @@index([slug])
  @@map("campaign")
}
